<!DOCTYPE html>
<html>
<head>
    <title>GitHub Stats Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .debug { background: #f5f5f5; padding: 10px; margin: 10px 0; border-left: 3px solid #007acc; }
        .error { background: #ffebee; border-left-color: #f44336; }
        .success { background: #e8f5e8; border-left-color: #4caf50; }
        #stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        .stat-card { background: white; border: 1px solid #ddd; padding: 20px; border-radius: 8px; }
    </style>
</head>
<body>
    <h1>GitHub Stats Loading Test</h1>
    <div id="debug-output"></div>
    
    <h2>GitHub Statistics</h2>
    <div id="stats-grid">
        <div class="loading">Loading stats...</div>
    </div>
    
    <h2>Language Statistics</h2>
    <div id="main-language-stats">
        <div class="loading">Loading language stats...</div>
    </div>

    <script>
        function log(message, type = 'info') {
            const debugDiv = document.getElementById('debug-output');
            const logDiv = document.createElement('div');
            logDiv.className = `debug ${type}`;
            logDiv.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            debugDiv.appendChild(logDiv);
            console.log(message);
        }

        // Test GitHub data loading
        async function testGitHubAPI() {
            log('üß™ Starting GitHub API test...');
            
            try {
                // Test cached data loading
                log('üìÅ Testing cached data fetch...');
                const response = await fetch('github-data.json');
                if (response.ok) {
                    const data = await response.json();
                    log(`‚úÖ Cached data loaded: ${Object.keys(data).join(', ')}`, 'success');
                    log(`üìä User: ${data.user?.login}, Repos: ${data.repositories?.length}`, 'success');
                    
                    // Test stats calculation
                    if (data.user && data.repositories) {
                        const totalStars = data.repositories.reduce((sum, repo) => sum + repo.stargazers_count, 0);
                        const totalForks = data.repositories.reduce((sum, repo) => sum + repo.forks_count, 0);
                        log(`‚≠ê Total stars: ${totalStars}, Total forks: ${totalForks}`, 'success');
                        
                        // Display stats
                        const statsGrid = document.getElementById('stats-grid');
                        statsGrid.innerHTML = `
                            <div class="stat-card">
                                <h3>${data.user.public_repos}</h3>
                                <p>Public Repositories</p>
                            </div>
                            <div class="stat-card">
                                <h3>${data.user.followers}</h3>
                                <p>Followers</p>
                            </div>
                            <div class="stat-card">
                                <h3>${totalStars}</h3>
                                <p>Total Stars</p>
                            </div>
                        `;
                        
                        // Test language stats
                        const languages = {};
                        for (const repo of data.repositories) {
                            if (repo.language) {
                                languages[repo.language] = (languages[repo.language] || 0) + 1;
                            }
                        }
                        
                        const sortedLanguages = Object.entries(languages)
                            .sort((a, b) => b[1] - a[1])
                            .slice(0, 5);
                        
                        const languageStats = document.getElementById('main-language-stats');
                        languageStats.innerHTML = `
                            <div>
                                <h4>Top Languages:</h4>
                                ${sortedLanguages.map(([lang, count]) => 
                                    `<div>${lang}: ${count} repositories</div>`
                                ).join('')}
                            </div>
                        `;
                        
                        log('‚úÖ Stats and languages displayed successfully', 'success');
                    }
                } else {
                    log(`‚ùå Failed to load cached data: ${response.status}`, 'error');
                }
            } catch (error) {
                log(`‚ùå Error testing GitHub API: ${error.message}`, 'error');
                console.error(error);
            }
        }

        // Run test when page loads
        document.addEventListener('DOMContentLoaded', testGitHubAPI);
    </script>
</body>
</html>